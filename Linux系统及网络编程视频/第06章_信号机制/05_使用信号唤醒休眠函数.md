# 5. 使用信号唤醒休眠函数

## 5.1 会导致休眠的函数

我们调用sleep、pause等函数时，这些函数会使进程进入休眠状态，如果你不想继续休眠时怎么办？

可以使用信号将其唤醒。

## 5.2 唤醒的方法

给信号登记一个空捕获函数即可，当然你也可以在捕获函数写你要的代码，不过如果仅仅只是用于唤醒的话，捕获函数的内容一般都是空的。

## 5.3 唤醒的过程

当信号发送给进程后，会中断当前休眠的函数，然后去执行捕获函数，捕获函数执行完毕返回后，不再调用休眠函数，而是执行休眠函数之后的代码，这样函数就被唤醒了。

## 5.4 我想继续休眠怎么办

我希望长期休眠的，但是不小心被别人发送的信号给唤醒了，我想继续休眠怎么办？

自己手动重新启动休眠函数（重新调用休眠函数）。	

演示：

+ 例子1：手动重启pause
+ 例子2：手动重启sleep

当你的休眠函数不希望被信号个打断时，我们就可以重启这个函数的调用。

## 5.5 休眠函数自动重启

比如使用read从键盘读取数据，当键盘没有输入任何数据时，read会休眠，不过函数被信号唤醒后，会自动重启read的调用  

注意：  
read函数读数据时，并不一定会休眠，读硬盘上的普通文件时，不管文件有没有数据，read都不会休眠，而是会返回继续向下运行，如果read读的是键盘的话，如果键盘没有数据时read就会休眠。

当read函数休眠时，如果被信号唤醒了，当捕获函数返回后，read会自动重启。演示：

我们需要记住那些函数是需要手动重启的，哪些函数是需要自动重启的？   
不需要，你只需要记住，对于绝大多数休眠函数来说，被信号中断后，如果你想继续休眠的话，需要自己去手动重启，否则就会继续向后运行。

如果你拿不准是自动重启的，还是需要手动重启的，有有两个方法来判断：

+ 自己去测试一下，如果被信号中断后，后续代码不会被执行的，就是自动的重启的，否者就是手动重启的

+ 看函数手册里面返回值的描述，如果描述里面有明确说明该函数可以被信号中断的话，这个函数就是手动重启的


